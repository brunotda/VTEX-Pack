/**
* Vtex Pack
* @version 2.17
* @date 2012-08-21
*/

/**
* Vtex Cart v2
* @author Carlos Vinicius
* @version 2.7
* @date 2012-09-21
*/
"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
jQuery.fn.vtexCart=function(i){var b=jQuery(this);if(1>b.length)return b;log=function(c,b){"object"===typeof console&&console.log("[Cart2 - "+(b||"Erro")+"] "+c)};var d=jQuery.extend({cartQtt:".vtex-cartQtt",cartTotal:".vtex-cartTotal",itemsText:".vtex-ItemsText",callback:function(){}},i),f=jQuery("");b.each(function(){var c=jQuery(this),b=c.find(d.cartQtt)||f,g=c.find(d.cartTotal)||f,h=c.find(d.itemsText)||f,e={getCartInfo:function(){0===document.location.host.indexOf("localhost")&&e.localhost();
jQuery.ajax({url:"/no-cache/QuantidadeItensCarrinho.aspx",success:e.cartInfoAjaxSuccess,error:e.cartInfoAjaxError})},localhost:function(){g.html("998,75");b.html(12);e.singularPlural(12)},cartInfoAjaxSuccess:function(a){var a=jQuery(a),d=a.find(".amount-items-em").html();1>a.filter(".cartInfoWrapper").length||(c.show(),g.html(a.find(".total-cart-em").html()),b.html(d),e.singularPlural(d))},cartInfoAjaxError:function(){log("N\u00e3o foi poss\u00edvel fazer a requisi\u00e7\u00e3o p/ obter os dados do carrinho.");
-1<document.location.host.indexOf("localhost")&&c.show()},singularPlural:function(a){a=parseInt(a,10);isNaN(a)?log("O valor obtido para calcular o plural/singular n\u00e3o \u00e9 um n\u00famero!"):1===a?h.hide().filter(".singular").show():h.hide().filter(".plural").show()}};e.getCartInfo()});d.callback();return b};
/**
* Newslleter V2
* @author Carlos Vinicius
* @version 3.6
* @date 2012-08-21
*/
"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
jQuery.fn.vtexNews2=function(l){var d=jQuery(this);if(d.length<1)return d;var b=jQuery.extend({defaultName:"Digite seu nome...",defaultEmail:"Digite seu e-mail...",nameField:".vtexNewsName",emailField:".vtexNewsEmail",btn:".vtexNewsButton",elementError:".nv2_messageError",elementSuccess:".nv2_messageSuccess",setDefaultName:true,checkNameExist:true,getAttr:"alt",showInPopup:true,successCallback:function(){}},l),e="object"===typeof console;if("function"!==typeof jQuery.fn.vtexPopUp2){e&&console.log("[vtexNews2 - Erro] O popUp2 n\u00e3o foi encontrado. Adicione o Plugin de PopUp2.");
return d}d.each(function(){var c=jQuery(this),f=c.find(b.nameField),d=c.find(b.emailField),g=c.find(b.btn),h=c.find(b.elementError),i=c.find(b.elementSuccess);if(f.length<1&&b.checkNameExist){e&&console.log("[vtexNews2] Campo de nome, n\u00e3o encontrado ("+f.selector+")");return c}if(d.length<1){e&&console.log("[vtexNews2] Campo de e-mail, n\u00e3o encontrado ("+d.selector+")");return c}if(g.length<1){e&&console.log("[vtexNews2] Bot\u00e3o de envio, n\u00e3o encontrado ("+g.selector+")");return c}if(i.length<
1||h.length<1){e&&console.log("[vtexNews2] A(s) mensagem(ns) de erro e/ou sucesso esta(m) faltando \n ("+i.selector+", "+h.selector+")");return c}b.setDefaultName&&f.is("input[type=text], textarea")&&f.val(b.defaultName);d.val(b.defaultEmail);b.checkNameExist&&f.filter(":visible").queue(function(){var a=jQuery(this),c=a.val();f.is("input, textarea")&&a.bind({focus:function(){a.val()==c&&(a.val().search(b.defaultName.substr(0,6))==0||b.setDefaultName)&&a.val("")},blur:function(){a.val()==""&&a.val(c)}})});
d.queue(function(){var a=jQuery(this),c=a.val();a.bind({focus:function(){a.val()==c&&a.val().search(b.defaultEmail.substr(0,6))==0&&a.val("")},blur:function(){a.val()==""&&a.val(c)}})});var j=function(){var a,d;d=(a=c.find(b.nameField).filter("input[type=text],select,textarea").val())?a:(a=c.find(b.nameField).filter("input[type=radio]:checked, input[type=checkbox]:checked").val())?a:(a=c.find(b.nameField).attr(b.getAttr))?a:(a=c.find(b.nameField).text())?a:(a=c.find(b.nameField).find(".box-banner img:first").attr("alt"))?
a:"";a=(c.find(b.emailField).val()||"").trim();var e=c.find(b.nameField).is(":visible");if((d.length<1||d.search(b.defaultName.substr(0,6))==0)&&(b.checkNameExist||e?e:1)||a.search(/^[a-z0-9\_\-\.]+@[a-z0-9\_\-]+(\.[a-z0-9\_\-]{2,})+$/i)<0)if(b.showInPopup)h.vtexPopUp2({popupType:"newsletter",popupClass:"popupNewsletterError"});else{h.slideDown().bind("click",function(){$(this).slideUp()});setTimeout(function(){h.slideUp()},1800)}else{g.attr("disabled","disabled");jQuery.ajax({url:"/no-cache/Newsletter.aspx",
type:"POST",data:{newsletterClientEmail:a,newsletterClientName:d,newsInternalCampaign:"newsletter:opt-in",newsInternalPage:(document.location.pathname||"/").replace(/\//g,"_"),newsInternalPart:"newsletter"},success:function(){g.removeAttr("disabled");b.showInPopup?i.vtexPopUp2({popupType:"newsletter",popupClass:"popupNewsletterSuccess"}):i.slideDown().bind("click",function(){$(this).slideUp()});b.setDefaultName&&f.is("input, textarea")&&c.find(b.nameField).val(b.defaultName);c.find(b.emailField).val(b.defaultEmail);
b.successCallback()}})}};g.bind("click",j);var k=function(a){if(13==(a.keyCode?a.keyCode:a.which)){a.preventDefault();j()}};f.filter("input, textarea").bind("keydown",k);d.bind("keydown",k)});return d};
/**
* Vtex Gift List
* @author Carlos Vinicius
* @version 1.5
* @date 2012-09-18
*/
jQuery.fn.vtexGiftlist=function(d){var e=jQuery(this);if(1>e.length)return e;var g=jQuery.extend({giftListWrap:".giftListWrap",popupShow:function(){},buyBtnFormat:function(a,c){var f=jQuery('<div class="giftListBtn"></div>'),b=jQuery('<div class="skuTplButtonsWrap"></div>');a.after(b);a.appendTo(b);c.appendTo(f);f.appendTo(b)}},d),d=jQuery("body");jQuery("");var a=d.find(g.giftListWrap),j="object"==typeof console;if(1>a.length)return j&&console.log("Elemento contendo o controle de lista n\u00e3o encontrado ("+
a.selector+")"),!1;var k=a.parent(),i=d.find("div.skuList"),h={actions:function(d){var c=d||e;c.bind("click",function(){var f,b;f=a.find(".giftlistcreate-nouser");a.find(".giftlistinsertsku").show();b=a.find(".giftlistinsertsku-message");if("block"==b.css("display"))return alert(b.text());b.css("display","block").hide();c.hasClass("multipleSkus")&&a.find(".giftlistinsertsku-button").each(function(){var a=jQuery(this),b=(a.attr("href")||"").split(",");b[1]="'"+c.attr("rel")+"'";a.attr("href",b.join(","))});
if(1>f.length)a.vtexPopUp2({initCallback:g.popupShow,closeCallback:function(){a.appendTo(k)}});else return alert("Voc\u00ea precisa estar logado para adicionar um item a lista."),document.location.href="https://"+document.location.host+"/Site/Login.aspx?ReturnUrl="+document.location.pathname,!1})},buyButton:function(){var a=i.find(".buy-button");if(1>a.length||2>i.length)return!1;var c=e.clone().addClass("multipleSkus");a.each(function(){var a=c.clone(),b=jQuery(this);g.buyBtnFormat(b,a);a.attr("rel",
(b.attr("href")||"").split("Sku=").pop());h.actions(a)});e.hide()}};h.actions();h.buyButton();return e};
/**
* PopUps
* @author Carlos Vinicius
* @version 1.24
* @date 2012-10-08
*/
jQuery.fn.vtexPopUp2=function(l){var j=jQuery(this);if(1>j.length)return j;var i=jQuery("body"),d=i.find(".boxPopUp2"),k="object"==typeof console;1>d.length&&(d=jQuery('<div class="boxPopUp2"><div class="boxPopUp2-wrap"><span class="boxPopUp2-close"></span><div class="boxPopUp2-content"></div></div></div>'),i.prepend(d),d.after('<div class="boxPopUp2-overlay"></div>'));var c=jQuery.extend({popupType:null,closeContent:null,popupClass:"",quickViewClass:".quickViewLink",contentUrl:"",initCallback:function(){},
showCallback:function(){},closeCallback:function(){}},l),l=d.find(".boxPopUp2-close"),e=d.find(".boxPopUp2-content"),m=i.find(".boxPopUp2-close, .boxPopUp2-overlay"),n=i.find(".boxPopUp2-overlay"),h=jQuery(document);null!=c.closeContent&&l.html(c.closeContent);var b={positioning:function(){var a=h.scrollTop(),b=jQuery(window).height(),c=d.outerHeight(!0);d.css("top",a+(c>=b?20:(b-c)/2)+"px")},show:function(a){a=a||{};n.fadeTo("fast",0.5,function(){d.show().addClass("popupOpened");"boolean"===typeof a.loading&&
!0===a.loading?b.showLoading():b.hideLoading();"function"===typeof a.callback&&a.callback();c.showCallback(d)})},hideLoading:function(){e.filter(":visible").css("background-image","none")},showLoading:function(){e.filter(":visible").css("background-image",'url("/arquivos/ajax-loader.gif")')},close:function(a){var a=a||{},b=function(){n.fadeOut("fast");d.fadeOut("fast",function(){e.empty()});e.attr("class","boxPopUp2-content");d.attr("class","boxPopUp2")};"boolean"==typeof a.closeNow&&!0==a.closeNow&&
b();1>m.filter(".boxPopUp2-clickActive").length&&(m.addClass("boxPopUp2-clickActive").bind("click",function(){"function"===typeof a.clickCallback?a.clickCallback():c.closeCallback(d);b()}),h.bind("keyup",function(a){27==(a.keyCode?a.keyCode:a.which)&&b()}));if(j.hasClass("autoClose")){var g=(j.attr("class")||"").split("ac_").pop().split(" ").shift();if(isNaN(parseFloat(g)))return k&&console.log("[Erro] O tempo informado (em segundos) n\u00e3o \u00e9 um valor num\u00e9rico: \u201c"+g+"\u201d"),!1;
setTimeout(function(){b()},1E3*g)}},setType:function(a){if(a.hasClass("quickViewLink"))b.quickView(a);else if(a.hasClass("giftListWrap"))b.giftList(a);else if(a.hasClass("installmentInfoTpl"))b.paymentForms(a);else if(a.hasClass("shipping-value"))b.calculateShipping(a);else if(a.hasClass("freeContent"))b.freeContent(a);else if(a.hasClass("boxPopUp2"))b.closeNow(a);else if(a.hasClass("referAFriendTpl"))b.productReferAFriend(a);else if(0<a.filter("#btnReferAFriend").length)b.giftListReferFriend(a);
else if(0<a.filter("#lnkPubliqueResenha").length)b.postRatingComment(a);else if(0<a.filter("#palerta").length)b.cartCheckoutAlert(a);else if(a.hasClass("lnkAddPhoto"))c.popupType="minhaContaFoto",b.userAccount(a);else return!1},checkType:function(a){"cadastroCliente"===c.popupType||"minhaContaFoto"===c.popupType?b.userAccount(a):"newsletter"===c.popupType?b.newsletter(a):"quickview"===c.popupType?b.quickView(a):"giftlist"===c.popupType?b.giftList(a):"paymentforms"===c.popupType?b.paymentForms(a):
"shipping"===c.popupType?b.calculateShipping(a):"string"==typeof c.popupType&&"freecontent"===c.popupType.toLowerCase()?b.freeContent(a):"closenow"===c.popupType?b.closeNow(a):"GiftListReferAFriend"===c.popupType?b.giftListReferFriend(a):"postRatingComment"===c.popupType?b.postRatingComment(a):b.freeContent(a)},exec:function(){j.each(function(){var a=$(this);null===c.popupType?b.setType(a):!1===b.checkType(a)&&b.setType(a)});c.initCallback()},userAccount:function(a){var f="";"cadastroCliente"===c.popupType?
f="signInPopups":"minhaContaFoto"===c.popupType&&(f="profilePhoto");a.unbind().removeAttr("onclick");var g=a.attr("href")||"";a.bind("mouseenter",function(){a.unbind().bind("click",function(){d.addClass(c.popupClass+" "+f+"Main");""===g&&k&&console.log("N\u00e3o existe URL no atributo href");jQuery('<iframe src="'+g+'" frameborder="0" allowtransparency="true"></iframe>').appendTo(e.addClass(c.popupClass+" "+f));b.show({loading:!0});b.positioning();b.close();return!1})})},newsletter:function(a){a.clone().appendTo(e.addClass(c.popupClass+
" newsletterPopup"));d.addClass(c.popupClass+" newsletterMain");b.show();b.positioning();b.close()},quickView:function(a){var a=i.find(c.quickViewClass),f=function(){a.filter(":not(.quickViewLinkActivated)").addClass("quickViewLinkActivated").bind("click",function(){jQuery('<iframe src="'+jQuery(this).attr("href")+'" frameborder="0" allowtransparency="true"></iframe>').appendTo(e.addClass(c.popupClass+" productQuickView"));d.addClass(c.popupClass+" quickViewMain");b.show({loading:!0});b.positioning();
b.close();return!1})};f();h.ajaxStop(f)},paymentForms:function(a){var f="",g=function(){var a=i.find(".see-other-payment-method-link");if(1>a.length)return k&&console.log("Url das formas de pagamento n\u00e3o encontrado. \n Verifique se o controle esta na p\u00e1gina.\n("+a.selector+")"),!1;f=/http:(.*?)(?=\&)/.exec(a[0].getAttribute("onclick").toString())[0]||"#onclickError"};g();a.bind("click",function(){jQuery("<iframe src='"+f+"' frameborder='0' allowtransparency='true'></iframe>").appendTo(e.addClass(c.popupClass+
" paymentFormsPopup"));d.addClass(c.popupClass+" paymentFormsMain");b.show({loading:!0});b.positioning();b.close();return!1});h.ajaxStop(g)},calculateShipping:function(){h.ajaxStop(function(){var a=i.find("#calculoFrete").children();if(1>a.length)return!1;a.find("span.cep-busca a").attr("target","_blank");a.appendTo(e.addClass(c.popupClass+" shippingCalculationPopup"));d.addClass(c.popupClass+" shippingCalculationMain");b.show();b.positioning();b.close()})},giftList:function(a){a.appendTo(e.addClass(c.popupClass+
" giftListPopup"));d.addClass(c.popupClass+" giftListMain");b.show();b.positioning();b.close({clickCallback:c.closeCallback})},cartCheckoutAlert:function(a){a.appendTo(e.addClass(c.popupClass+" cartCheckoutAlertPopup"));d.addClass(c.popupClass+" cartCheckoutAlertMain");b.show();b.positioning();b.close()},freeContent:function(a){""==c.contentUrl?a.appendTo(e.addClass(c.popupClass+" freeContentPopup")):jQuery('<iframe src="'+c.contentUrl+'" frameborder="0" allowtransparency="true"></iframe>').appendTo(e.addClass(c.popupClass+
" freeContentPopup"));d.addClass(c.popupClass+" freeContentMain");b.show();b.positioning();b.close()},closeNow:function(){b.close({closeNow:!0})},giftListReferFriend:function(a){var f=function(){var a=$(this).attr("href");if("undefined"===typeof a||""===a)return k&&console.log("[Erro] Url do popup n\u00e3o encontrada."),!1;e.addClass(c.popupClass+" freeContentPopup").load(a);d.addClass(c.popupClass+" giftListReferFriendMain");b.show({loading:!0});b.positioning();b.close();return!1},g=function(){a.unbind().bind("mouseenter",
function(){a.unbind().bind("click",f)})};g();h.ajaxStop(g)},productReferAFriend:function(a){var f=jQuery('<div class="referAFriendPopUpWrap"></div>');a.bind("click",function(){var a=(jQuery(this).parent().find("#div-referAFriend input").attr("onclick")||"").toString(),a=/\/referAFriend\/Form\/[0-9]+\?/i.exec(a);if(null===a)return alert("Desculpe, n\u00e3o foi poss\u00edvel abrir o formul\u00e1rio."),!1;f.empty().load(a[0],function(){b.positioning()});f.appendTo(e.addClass(c.popupClass+" freeContentPopup"));
d.addClass(c.popupClass+" freeContentMain");b.show();b.positioning();b.close();return!1});h.ajaxStop(function(){0<e.find(".referAFriendPopUpWrap #btnFechar").length&&setTimeout(b.closeNow,1500)})},postRatingComment:function(a){var a=a.filter(":not(.popUpPublishReviewActivated)"),f=!1;if(1>a.length)return!1;a.bind("click",function(){var a=jQuery(this).attr("href")||"";if(""===a)return k&&console.log("[Erro] N\u00e3o foi poss\u00edvel obter os dados para abrir o popup de resenha."),!1;a=a.split(")").shift().split("(").pop().split(",");
if(3!=a.length)return k&&console.log("[Erro] O array com os dados do cliente retornou um valor inesperado."),!1;if(f)return!1;f=!0;jQuery.ajax({url:"/publishuserreviewcomment",type:"POST",data:{productId:a[1],clientId:a[0],categoryId:a[2]},success:function(a){var g=jQuery(a);e.addClass(c.popupClass+" userReviewPopup").html(g);d.addClass(c.popupClass+" userReviewPopupMain");b.show({callback:function(){g.find("#txtTituloResenha:hidden").val("titulo_auto");var a=e.find("a#rtAvaliacao_A0"),b=function(){a.attr("title",
a.find(".filledRatingStar:last").index()+1||0)};a.find("span").bind("mouseenter",b);a.bind("mouseleave",b)}});b.positioning();b.close();f=!1},error:function(){f=!1}});return!1}).addClass("popUpPublishReviewActivated");0==jQuery.fn.vtexPopUp2.data.userReviewCount&&h.ajaxStop(function(){e.hasClass("userReviewPopup")&&0==e.find(".formUserComment").children().length&&b.closeNow()});jQuery.fn.vtexPopUp2.data.userReviewCount++}};b.exec();return j};jQuery.fn.vtexPopUp2.data={userReviewCount:0};

// AUTOLOADS
$(function(){
	var b=$("body");
	/* Carriho */ b.find(".cartWrapper").vtexCart();
	/* Gift List */ b.find(".giftListButtonTpl").vtexGiftlist();
	/* Newsletter */ b.find(".vtexNewsWrap").vtexNews2();
	/* Quickview */ b.find(".quickViewLink").vtexPopUp2();
	/* Formas de pagamento */ b.find(".installmentInfoTpl").vtexPopUp2();
	/* Cálculo de frete */ b.find(".shipping-value").vtexPopUp2();
	/* Inidcar a um amigo (Pág. Listas Gerenciar) */ b.find("td.giftlist-body-action-sendfriend #btnReferAFriend").vtexPopUp2();
	/* Minha conta - alterar foto */ b.filter(".minha-conta").find(".lnkAddPhoto").vtexPopUp2();
	/* cadastro */ b.filter(".cadastro-cliente").find(".thickbox").vtexPopUp2({"popupType":"cadastroCliente"});
	/* Indicar à um amigo (pg. Produto) */ b.find(".referAFriendTpl").vtexPopUp2();
});
$(document).ajaxStop(function(){
	var b=$("body");
	/* Publicar comentário sobre o produto */ b.find("#lnkPubliqueResenha[href*='javascript']").vtexPopUp2();
	/* Quickview */ b.find(".quickViewLink").vtexPopUp2();
});